---
layout: post
title: "支付、双重支付和比特币——通俗解释区块链（一）"
date: 2020-02-29
---

## 支付

十年前某个阳光明媚的下午，一位顾客走进星爸爸咖啡，从自己的钱包里掏出 30 元钱，交给收银员，购买了一杯热美式。十年后的今天，这样的场景已经很少见了，科技的发展将我们带入数字世界，大多数时候我们使用数字化支付手段——微信和支付宝完成支付，再也不用携带钱包和钞票。

与十年前相比，付钱这件事似乎变得更加简单。实际上，与手对手的钱货交换相比，通过微信支付的 30 元钱却经历了更加复杂的过程。首先，30 元钱从顾客的银行卡流出，转移到微信平台的账户余额里，而这笔交易需要由网联进行清算，清算完成后，这笔交易算是完成了一半；微信平台会在 T+N 日将 T 日收到的所有货款转至星爸爸绑定的对公账户，这同样需要网联进行清算，直到此次清算完成，星爸爸才真正收到了这 30 元钱。

![Payment](/assets/20200229/payment.png)

## 复制

为什么数字化的支付流程如此复杂呢？我们从数字世界的一个基本特征说起。

如果你需要发给同事一封附带文档的电子邮件，通常会打开邮箱，新建邮件，从桌面上拖入文档，填写标题和收件人，点击发送。当邮件状态显示为“已发送”时，同事和你自己都拥有了这份文档的副本——是的，当我们在数字世界中说“发送”的时候，我们通常做的是“复制”。

Ctrl+C，Ctrl+V 是被使用最多的快捷键。数字世界的默认行为是复制。

## 双重支付

重新回到那个阳光明媚的下午，当顾客走进星爸爸，掏出手机，打开了数字世界的钱包，从里面拿出了 30 元钱，“发送”给了对面的收银员……等等，谁能保证这 30 元钱确实从顾客的钱包里扣除了呢？也许，这个顾客刚刚把同样的 30 元钱，“发送”给了马路对面的肯塔基店员，购买了手里的汉堡？

这便是数字货币领域最重要的“[双重支付](https://zh.wikipedia.org/wiki/%E9%9B%99%E9%87%8D%E6%94%AF%E4%BB%98)”问题。

## 中介

一开始，我们使用银行卡来解决这个问题。既然将钱直接放在顾客的手机里没办法避免双重支付，那大家都把钱存在银行里吧，余额变成了银行卡上的一个数字，银行保证在给星爸爸的账户增加 30 元的同时扣掉顾客的 30 元钱，不然它就亏了。

后来，银行开始变多了，顾客喜欢葵花银行，而星爸爸则选择了在建造银行开设自己的对公账户。于是，清算机构银联出现了，银联保证在给建造银行增加 30 元的同时扣掉葵花银行的 30 元钱，不然它就亏了。

再后来，第三方支付——微信、支付宝等产品出现了，凭借着良好的用户体验和强大的推广能力，它们很快成为了顾客的宠儿。网联也应运而生，成为了第三方支付和银行间的清算机构。至此，终于形成了本文开篇提到的支付场景。

## 比特币

2008 年，一个叫中本聪的神秘人向世界宣称，不需要中介，我也能解决双重支付问题，这便是比特币。

比特币的思想很朴实——发动群众，一起扮演支付中介的角色。被发动的群众称为节点，下面这个小故事讲述了节点们的日常。

> 安静明亮的教室里，节点们都在辛勤工作着。每个节点的课桌上都摆着一条链条，上面串着一些被称为“区块”的东西，这些区块上记录着大量的交易历史。有趣的是，不同链条上所串着的区块基本都一样。
>
> 同时，各种各样新的交易信息源源不断地从世界各地传来，顾客付给星爸爸的 30 元钱也在其中。
>
> 节点们的工作就是找到一个数学问题的答案，这个答案可以让他们把新收到的交易信息打包成新的区块，串在链条的尾端。
>
> 突然，一位同学起身。
>
> 原来，这位幸运儿已经找到了答案，他开始把新的区块分发给其他人。收到区块的节点默默叹息一声，将新区块串在自己的链条尾部，来不及多感慨，便投入到下一个问题的计算当中。完成了这一切，幸运儿回到座位上，开心地领走了属于自己的奖励，也开始解答下一个问题，教室里又安静了下来。
>
> 又过了一会，一位年轻的节点站了起来，略显紧张地开始向其他人分发区块。然而，还没发出去几份，就听到一位年纪比较大的节点说：“年轻人，你的结果不对呀，这笔顾客转给肯塔基的 30 元钱……双重支付啦！”
>
> 教室里顿时热闹起来，周围的节点议论纷纷。年轻的节点站在教室中间，涨红了脸，进退两难，显得有些尴尬。
>
> 这时，角落里另一个节点站了起来。“我算出来了！没打包那笔双重支付的交易。”并飞快地向大家分发着他的新区块。
>
> 收到新区块的节点们简单地验证了一下，便纷纷停止了议论，把区块串在他们的链条上，开始了新的计算。
>
> 后站起来的节点把区块分发得差不多了，便走到年轻节点旁边，把他按回座位上，将正确的区块塞到他手里，小声说道：“加油，别作弊！”就赶回自己的座位，继续工作了起来。年轻的区块扫视了一圈，发现已经没有人在关心自己了，悻悻地把自己的假区块丢在一旁，也开始了新一轮的工作。

当然，真实世界的节点们只是被网络连接起来的计算机。由于时不时能取得打包区块的奖励，他们的工作也被称为“挖矿”。而那个被所有节点拼命追求的答案则通常被叫做“工作量证明”。

聪明的中本聪利用巧妙的激励机制构建了一个能够避免双重支付的去中心化账本，比特币的故事也从此开始。
